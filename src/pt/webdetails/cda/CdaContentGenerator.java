/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this file,
 * You can obtain one at http://mozilla.org/MPL/2.0/. */

package pt.webdetails.cda;

import java.io.OutputStream;



import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.pentaho.platform.api.engine.IParameterProvider;
import org.pentaho.platform.api.repository.IContentItem;

import pt.webdetails.cpf.SimpleContentGenerator;

public class CdaContentGenerator extends SimpleContentGenerator
{
  
  
  
  private boolean edit = false;

  private static Log logger = LogFactory.getLog(CdaContentGenerator.class);
  public static final String PLUGIN_NAME = "cda";
  private static final long serialVersionUID = 1L;
  private static final String EDITOR_SOURCE = "/editor/editor.html";
  private static final String EXT_EDITOR_SOURCE = "/editor/editor-cde.html";
  private static final String PREVIEWER_SOURCE = "/previewer/previewer.html";
  private static final String CACHE_MANAGER_PATH = "system/" + PLUGIN_NAME + "/cachemanager/cache.html";
  private static final int DEFAULT_PAGE_SIZE = 20;
  private static final int DEFAULT_START_PAGE = 0;
  private static final String PREFIX_PARAMETER = "param";
  private static final String PREFIX_SETTING = "setting";
  
  @Override
  public void createContent() throws Exception {
    CdaUtils utils = new CdaUtils();

    if (edit)
      utils.editFile(getResponse(), getRequest());
    else
      utils.previewQuery(getResponse(), getRequest());
  }

  public void syncronize(final IParameterProvider pathParams, final OutputStream out) throws Exception
  {
    throw new UnsupportedOperationException("Feature not implemented yet");
//    final SyncronizeCdfStructure syncCdfStructure = new SyncronizeCdfStructure();
//    syncCdfStructure.syncronize(userSession, out, pathParams);
  }


  @Override
  public Log getLogger()
  {
    return logger;
  }

  @Override
  public String getPluginName() {
    return "cda";
  }


  /**
   * @return the edit
   */
  public boolean isEdit()
  {
    return edit;
  }


  /**
   * @param edit the edit to set
   */
  public void setEdit(boolean edit)
  {
    this.edit = edit;
  }
}
